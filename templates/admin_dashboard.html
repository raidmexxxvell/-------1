<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - –õ–∏–≥–∞ –û–±–Ω–∏–Ω—Å–∫–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="/static/js/error-overlay.js"></script>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/database-ui.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'><text y='14' font-size='14'>‚öΩ</text></svg>">
</head>
<body class="tg">
    <div class="app-container">
        <!-- Header -->
        <div class="header">
            <h1 class="app-title">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Admin Subtabs -->
            <div id="admin-subtabs" class="subtabs">
                <div class="subtab-item active" data-atab="matches">–ú–∞—Ç—á–∏ –∏ —Å–æ—Å—Ç–∞–≤—ã</div>
                <div class="subtab-item" data-atab="teams">–ö–æ–º–∞–Ω–¥—ã</div>
                <div class="subtab-item" data-atab="players">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏</div>
                <div class="subtab-item" data-atab="news">–ù–æ–≤–æ—Å—Ç–∏</div>
                <div class="subtab-item" data-atab="service">–°–µ—Ä–≤–∏—Å</div>
                <div class="subtab-item" data-atab="stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                <div class="subtab-item" data-atab="logs">–õ–æ–≥–∏</div>
            </div>

            <!-- Matches and Lineups Pane -->
            <div id="admin-pane-matches" class="admin-pane">
                <div class="admin-section">
                    <h3>–ë–ª–∏–∂–∞–π—à–∏–µ –º–∞—Ç—á–∏</h3>
                    <button id="admin-matches-refresh" class="action-btn">–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–∞—Ç—á–µ–π</button>
                    <div id="matches-list" class="matches-container">
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ø–∏—Å–∫–æ–º –º–∞—Ç—á–µ–π -->
                    </div>
                </div>

                <!-- Match Details Modal -->
                <div id="match-details-modal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="match-details-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–∞</h3>
                            <button class="modal-close" onclick="closeMatchModal()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="teams-container">
                                <!-- Home Team -->
                                <div class="team-section">
                                    <h4 id="home-team-name">–ö–æ–º–∞–Ω–¥–∞ 1</h4>
                                    <div class="lineup-section">
                                        <h5>–û—Å–Ω–æ–≤–Ω–æ–π —Å–æ—Å—Ç–∞–≤</h5>
                                        <textarea id="home-main-lineup-input" class="bulk-lineup-input" 
                                                  placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É):&#10;–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω&#10;–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä&#10;–°–∏–¥–æ—Ä–æ–≤ –°–∏–¥–æ—Ä"></textarea>
                                        <div id="home-main-lineup" class="lineup-list">
                                            <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–æ—Å—Ç–∞–≤ –∫–æ–º–∞–Ω–¥—ã —Ö–æ–∑—è–µ–≤ -->
                                        </div>
                                        <button class="update-lineup-btn" onclick="window.AdminEnhanced.updateTeamLineup('home')">–û–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–∞–≤</button>
                                    </div>
                                </div>

                                <!-- Away Team -->
                                <div class="team-section">
                                    <h4 id="away-team-name">–ö–æ–º–∞–Ω–¥–∞ 2</h4>
                                    <div class="lineup-section">
                                        <h5>–û—Å–Ω–æ–≤–Ω–æ–π —Å–æ—Å—Ç–∞–≤</h5>
                                        <textarea id="away-main-lineup-input" class="bulk-lineup-input" 
                                                  placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É):&#10;–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω&#10;–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä&#10;–°–∏–¥–æ—Ä–æ–≤ –°–∏–¥–æ—Ä"></textarea>
                                        <div id="away-main-lineup" class="lineup-list">
                                            <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–æ—Å—Ç–∞–≤ –∫–æ–º–∞–Ω–¥—ã –≥–æ—Å—Ç–µ–π -->
                                        </div>
                                        <button class="update-lineup-btn" onclick="window.AdminEnhanced.updateTeamLineup('away')">–û–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–∞–≤</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="modal-actions">
                                <button id="save-lineups-btn" class="action-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤—ã</button>
                                <button class="cancel-btn" onclick="closeMatchModal()">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Players Management Pane -->
            <!-- Teams Management Pane -->
            <div id="admin-pane-teams" class="admin-pane" style="display: none;">
                <div class="admin-section">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–∞–º–∏</h3>
                    <div class="teams-controls">
                        <input type="text" id="team-search" placeholder="–ü–æ–∏—Å–∫ –∫–æ–º–∞–Ω–¥..." class="search-input">
                        <button id="add-new-team-btn" class="action-btn">+ –ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞</button>
                        <button id="refresh-teams-btn" class="action-btn">–û–±–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                    
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th>–ì–æ—Ä–æ–¥</th>
                                    <th>–õ–æ–≥–æ—Ç–∏–ø</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="teams-table">
                                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Add/Edit Team Modal -->
                <div id="team-modal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="team-modal-title">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É</h3>
                            <button class="modal-close" onclick="window.AdminEnhanced.closeTeamModal()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <form id="team-form">
                                <div class="form-group">
                                    <label for="team-name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã:</label>
                                    <input type="text" id="team-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="team-city">–ì–æ—Ä–æ–¥:</label>
                                    <input type="text" id="team-city">
                                </div>
                                <div class="form-group">
                                    <label for="team-founded-year">–ì–æ–¥ –æ—Å–Ω–æ–≤–∞–Ω–∏—è:</label>
                                    <input type="number" id="team-founded-year" min="1900" max="2030">
                                </div>
                                <div class="form-group">
                                    <label for="team-logo-url">URL –ª–æ–≥–æ—Ç–∏–ø–∞:</label>
                                    <input type="url" id="team-logo-url" placeholder="https://example.com/logo.png">
                                </div>
                                <div class="form-group">
                                    <label for="team-description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                                    <textarea id="team-description" rows="3"></textarea>
                                </div>
                                <div class="form-actions">
                                    <button type="submit" class="action-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                    <button type="button" class="cancel-btn" onclick="closeTeamModal()">–û—Ç–º–µ–Ω–∞</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Team Roster Modal -->
                <div id="team-roster-modal" class="modal" style="display:none;">
                    <div class="modal-content" style="max-width:700px;">
                        <div class="modal-header">
                            <h3 id="team-roster-title">–°–æ—Å—Ç–∞–≤ –∫–æ–º–∞–Ω–¥—ã</h3>
                            <button class="modal-close" onclick="window.AdminEnhanced.closeTeamRoster()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div id="team-roster-status" class="status-text" style="display:none;"></div>
                            <div class="table-container">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>–ò–º—è</th>
                                            <th>–§–∞–º–∏–ª–∏—è</th>
                                            <th>–ì–æ–ª—ã</th>
                                            <th>–ü–∞—Å—ã</th>
                                            <th>–ñ–ö</th>
                                            <th>–ö–ö</th>
                                        </tr>
                                    </thead>
                                    <tbody id="team-roster-table">
                                        <!-- –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Players Management Pane -->
            <div id="admin-pane-players" class="admin-pane" style="display: none;">
                <div class="admin-section">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞–º–∏</h3>
                    <div class="players-controls">
                        <input type="text" id="player-search" placeholder="–ü–æ–∏—Å–∫ –∏–≥—Ä–æ–∫–æ–≤..." class="search-input">
                        <select id="team-filter" class="team-select">
                            <option value="">–í—Å–µ –∫–æ–º–∞–Ω–¥—ã</option>
                            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                        </select>
                        <button id="add-new-player-btn" class="action-btn">+ –ù–æ–≤—ã–π –∏–≥—Ä–æ–∫</button>
                    </div>
                    
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>–ò–º—è</th>
                                    <th>–ö–æ–º–∞–Ω–¥–∞</th>
                                    <th>–ü–æ–∑–∏—Ü–∏—è</th>
                                    <th>–ù–æ–º–µ—Ä</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="players-table">
                                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Add/Edit Player Modal -->
                <div id="player-modal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="player-modal-title">–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä–æ–∫–∞</h3>
                            <button class="modal-close" onclick="closePlayerModal()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <form id="player-form">
                                <div class="form-group">
                                    <label for="player-name">–ò–º—è –∏–≥—Ä–æ–∫–∞:</label>
                                    <input type="text" id="player-name" required>
                                </div>
                                <div class="form-group">
                                    <label for="player-team">–ö–æ–º–∞–Ω–¥–∞:</label>
                                    <select id="player-team" required>
                                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="player-position">–ü–æ–∑–∏—Ü–∏—è:</label>
                                    <select id="player-position">
                                        <option value="GK">–í—Ä–∞—Ç–∞—Ä—å</option>
                                        <option value="DEF">–ó–∞—â–∏—Ç–Ω–∏–∫</option>
                                        <option value="MID">–ü–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫</option>
                                        <option value="FWD">–ù–∞–ø–∞–¥–∞—é—â–∏–π</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="player-number">–ù–æ–º–µ—Ä:</label>
                                    <input type="number" id="player-number" min="1" max="99">
                                </div>
                                <div class="form-group">
                                    <label for="player-status">–°—Ç–∞—Ç—É—Å:</label>
                                    <select id="player-status">
                                        <option value="active">–ê–∫—Ç–∏–≤–Ω—ã–π</option>
                                        <option value="injured">–¢—Ä–∞–≤–º–∏—Ä–æ–≤–∞–Ω</option>
                                        <option value="suspended">–î–∏—Å–∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</option>
                                        <option value="inactive">–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π</option>
                                    </select>
                                </div>
                                <div class="modal-actions">
                                    <button type="submit" class="action-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                    <button type="button" class="cancel-btn" onclick="closePlayerModal()">–û—Ç–º–µ–Ω–∞</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- News Management Pane -->
            <div id="admin-pane-news" class="admin-pane" style="display: none;">
                <div class="admin-section">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç—è–º–∏</h3>
                    <div class="news-controls">
                        <button id="add-new-news-btn" class="action-btn" onclick="window.AdminEnhanced.openNewsModal()">+ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å</button>
                    </div>
                    
                    <div id="news-list" class="news-container">
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–æ–≤–æ—Å—Ç—è–º–∏ -->
                    </div>
                </div>

                <!-- Add/Edit News Modal -->
                <div id="news-modal" class="modal" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 id="news-modal-title">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å</h3>
                            <button class="modal-close" onclick="window.AdminEnhanced.closeNewsModal()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <form id="news-form">
                                <div class="form-group">
                                    <label for="news-title">–ó–∞–≥–æ–ª–æ–≤–æ–∫:</label>
                                    <input type="text" id="news-title" required>
                                </div>
                                <div class="form-group">
                                    <label for="news-content">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:</label>
                                    <textarea id="news-content" rows="8" required></textarea>
                                </div>
                                <div class="modal-actions">
                                    <button type="button" id="save-news-btn" class="action-btn" onclick="window.AdminEnhanced.saveNews()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                                    <button type="button" class="cancel-btn" onclick="window.AdminEnhanced.closeNewsModal()">–û—Ç–º–µ–Ω–∞</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Service Pane -->
            <div id="admin-pane-service" class="admin-pane" style="display: none;">
                <div class="admin-section">
                    <h3>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö</h3>
                    <button id="admin-refresh-all" class="action-btn">–û–±–Ω–æ–≤–∏—Ç—å –≤—Å—ë</button>
                    <p class="help-text">–ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.</p>
                    <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; align-items:center;"></div>
                </div>
                <div class="admin-section" style="border-color:#2d3748;">
                    <h3>–°—Ç–∞—Ç—É—Å —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–∏–Ω–∫–∞</h3>
                    <div class="admin-controls" style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
                        <button id="admin-health-sync-refresh" class="action-btn" style="background:#2d3748;">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
                        <span class="help-text">–ü—Ä–æ—Å–º–æ—Ç—Ä /health/sync (–º–µ—Ç—Ä–∏–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –∫–≤–æ—Ç—ã Sheets)</span>
                    </div>
                    <pre id="admin-health-sync-view" style="margin-top:8px; max-height:220px; overflow:auto; background:#0f0f0f; color:#ddd; border:1px solid #333; padding:8px; border-radius:6px;">‚Äî</pre>
                </div>
                <div class="admin-section">
                    <h3>–°–µ–∑–æ–Ω</h3>
                    <div style="display:flex; gap:8px; flex-wrap:wrap; align-items:center;">
                        <button id="admin-season-dry" class="action-btn" style="background:#555;">–ü–ª–∞–Ω —Å–±—Ä–æ—Å–∞ (dry)</button>
                        <button id="admin-season-soft" class="action-btn" style="background:#6a5acd;">–ú—è–≥–∫–∏–π —Å—Ç–∞—Ä—Ç</button>
                        <button id="admin-season-roll" class="action-btn danger" style="background:#b22222;">–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å</button>
                        <button id="admin-season-rollback" class="action-btn" style="background:#2d3748;">–û—Ç–∫–∞—Ç —Å–µ–∑–æ–Ω–∞</button>
                        <label style="display:flex; align-items:center; gap:6px; font-size:12px; background:#1a1a1a; padding:6px 8px; border-radius:6px;">
                            <input type="checkbox" id="season-rollover-deep"> –ì–ª—É–±–æ–∫–æ (deep)
                        </label>
                        <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
                            <button type="button" class="action-btn action-btn-ghost" title="–¢–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä" style="cursor:default;">
                                –ê–∫—Ç–∏–≤–Ω—ã–π —Å–µ–∑–æ–Ω: <span id="active-season-label" style="font-weight:700; margin-left:6px;">‚Äî</span>
                            </button>
                            <select id="season-picker" class="select-like">
                                <option value="">–ó–∞–≥—Ä—É–∑–∫–∞...</option>
                            </select>
                            <button id="apply-season-btn" class="action-btn" style="background:#444;">–°–¥–µ–ª–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–º</button>
                        </div>
                    </div>
                    <!-- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ–∑–æ–Ω–∞ (—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ) -->
                    <div style="margin-top:10px; padding:10px; border:1px solid #333; border-radius:8px; background:#0f0f0f;">
                        <h4 style="margin:0 0 8px 0;">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Å–µ–∑–æ–Ω–∞</h4>
                        <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
                            <label style="display:flex; gap:6px; align-items:center;">
                                –î–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞:
                                <input id="season-generate-date" type="text" placeholder="–î–î.–ú–ú.–ì–ì–ì–ì" style="background:#111; color:#fff; border:1px solid #333; padding:6px 8px; border-radius:6px; min-width:140px;">
                            </label>
                            <span class="help-text" style="margin:0;">–°–ª–æ—Ç—ã: 10:00, 11:00, 12:00, 13:00, –∫–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ</span>
                            <span id="season-generate-label" class="help-text" style="margin-left:auto; font-weight:600;">–ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Å–µ–∑–æ–Ω: ‚Äî</span>
                        </div>
                        <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:10px;">
                            <button id="admin-season-generate-soft" class="action-btn" style="background:#2f855a;">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∑–æ–Ω (–º—è–≥–∫–∏–π —Å—Ç–∞—Ä—Ç)</button>
                            <button id="admin-season-generate-full" class="action-btn" style="background:#b22222;">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∑–æ–Ω (–ø–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å)</button>
                        </div>
                        <p class="help-text" style="margin-top:6px;">
                            –ú—è–≥–∫–∏–π —Å—Ç–∞—Ä—Ç: –≤–µ—Ä–Ω—ë—Ç 409, –µ—Å–ª–∏ –≤ –∞–∫—Ç–∏–≤–Ω–æ–º —Ç—É—Ä–Ω–∏—Ä–µ —É–∂–µ –µ—Å—Ç—å –º–∞—Ç—á–∏ (–Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ). –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å: –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Ç–µ–∫—É—â–∏–π —Å–µ–∑–æ–Ω (–¥–ª—è —á–∏—Å—Ç–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞/—Ç–µ—Å—Ç–æ–≤).
                        </p>
                    </div>
                    <p class="help-text">–ü–ª–∞–Ω ‚Äî –ø—Ä–æ–±–Ω—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π. –ú—è–≥–∫–∏–π ‚Äî –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ª–Ω—ã–π ‚Äî —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. Deep + –ü–æ–ª–Ω—ã–π ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª—è–µ—Ç –º–∞—Ç—á–∏ –ø—Ä–æ—à–ª–æ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞ –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –Ω–æ–≤–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ.</p>
                    <pre id="season-rollover-log" style="max-height:160px; overflow:auto; font-size:12px; background:#111; padding:8px; border:1px solid #333; border-radius:6px; display:none;"></pre>
                    <div class="help-text" style="margin-top:6px; line-height:1.4;">
                        –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –æ—à–∏–±–∫–∞–º –æ—Ç–∫–∞—Ç–∞:
                        <ul style="margin:6px 0 0 18px;">
                            <li><b>Not Found</b> ‚Äî —ç–Ω–¥–ø–æ–∏–Ω—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø—É—Ç—å <code>POST /api/admin/season/rollback</code>; –µ—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —ç—Ç–æ, –æ–±–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏.</li>
                            <li><b>no_rollover_history</b> ‚Äî –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ –∂—É—Ä–Ω–∞–ª–µ <code>season_rollovers</code>. –°–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ ¬´–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å¬ª (rollover).</li>
                            <li><b>active_mismatch</b> ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ rollover. –ú–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º <code>?force=1</code> (–∫–Ω–æ–ø–∫–∞ –ø–æ–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ).</li>
                            <li><b>tournament_not_found</b> ‚Äî –∑–∞–ø–∏—Å–∏ —Ç—É—Ä–Ω–∏—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –ø–æ id. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –ë–î.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Stats Pane -->
            <div id="admin-pane-stats" class="admin-pane" style="display: none;">
                <div class="admin-section">
                    <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <button id="admin-stats-refresh" class="action-btn">–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
                    <div id="admin-stats-display" class="stats-container">
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞—Ç—á–µ–π –∏ —Å–æ—Å—Ç–∞–≤–æ–≤ -->
                    </div>
                </div>

                <!-- Data Repair Section -->
                <div class="admin-section">
                    <h3>üîß –ü–æ—á–∏–Ω–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
                    <div class="admin-controls">
                        <button id="fix-results-tours-btn" class="action-btn">–ü–æ—á–∏–Ω–∏—Ç—å –Ω–æ–º–µ—Ä–∞ —Ç—É—Ä–æ–≤ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö</button>
                        <div id="fix-results-tours-status" class="status-message"></div>
                    </div>
                </div>
            </div>

            <!-- Logs Pane -->
            <div id="admin-pane-logs" class="admin-pane" style="display: none;">
                <div class="admin-section">
                    <h3>–õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                    
                    <!-- –§–∏–ª—å—Ç—Ä—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
                    <div class="logs-controls" style="display: flex; gap: 10px; margin-bottom: 15px; align-items: center; flex-wrap: wrap;">
                        <input type="text" id="logs-action-filter" placeholder="–§–∏–ª—å—Ç—Ä –ø–æ –¥–µ–π—Å—Ç–≤–∏—é..." class="search-input" style="max-width: 200px;">
                        <select id="logs-status-filter" class="team-select" style="max-width: 150px;">
                            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="success">–£—Å–ø–µ—à–Ω—ã–µ</option>
                            <option value="error">–û—à–∏–±–∫–∏</option>
                            <option value="metrics">–ú–µ—Ç—Ä–∏–∫–∏</option>
                        </select>
                        <button id="admin-logs-refresh" class="action-btn">–û–±–Ω–æ–≤–∏—Ç—å</button>
                        <button id="admin-logs-clear-filters" class="action-btn" style="background: #666;">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                        <button id="admin-metrics-refresh" class="action-btn" style="display:none; background:#2b6cb0;">–û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏</button>
                        <label id="metrics-autorefresh-wrapper" style="display:none; font-size:12px; background:#1a1a1a; padding:4px 8px; border-radius:6px; align-items:center; gap:4px; cursor:pointer;">
                            <input type="checkbox" id="metrics-autorefresh" style="margin-right:4px;"> –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                        </label>
                    </div>
                    
                    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ª–æ–≥–æ–≤ -->
                    <div id="admin-logs-display" class="logs-container">
                        <div class="loading-indicator" style="text-align: center; padding: 20px;">
                            –ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...
                        </div>
                    </div>
                    
                    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
                    <div id="logs-pagination" class="pagination-controls" style="display: none; margin-top: 15px; text-align: center;">
                        <button id="logs-prev-page" class="action-btn" style="background: #444;">‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∞—è</button>
                        <span id="logs-page-info" style="margin: 0 15px; color: #ccc;">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1</span>
                        <button id="logs-next-page" class="action-btn" style="background: #444;">–°–ª–µ–¥—É—é—â–∞—è ‚Üí</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/static/js/telegram-patch.js"></script>
    <script src="/static/js/admin-enhanced.js"></script>
</body>
</html>