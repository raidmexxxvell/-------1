# –ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üîÑ –°—Ç—Ä–∞—Ç–µ–≥–∏—è rollback –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ "–õ–∏–≥–∞ –û–±–Ω–∏–Ω—Å–∫–∞"

### 1. Feature Flags (–∑–∞—â–∏—Ç–∞ –æ—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π)

#### –í–∫–ª—é—á–µ–Ω–Ω—ã–µ feature flags:
- `feature:match_ui_store` - –ü–æ–¥–ø–∏—Å–∫–∞ UI –¥–µ—Ç–∞–ª–µ–π –º–∞—Ç—á–∞ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–æ—Ä
- `feature:admin:season_reset` - –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö —Å–µ–∑–æ–Ω–∞
- `feature:admin:order_delete` - –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
- `feature:admin:news_delete` - –£–¥–∞–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π
- `feature:admin:team_delete` - –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥
- `feature:admin:event_remove` - –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –º–∞—Ç—á–µ–π
- `feature:admin:user_data_repair` - –ü–æ—á–∏–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- `feature:admin:force_refresh` - –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞

#### –ë—ã—Å—Ç—Ä–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö feature flags:
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
Object.keys(localStorage).filter(k => k.startsWith('feature:')).forEach(k => localStorage.removeItem(k));
location.reload();
```

#### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–ª–∞–≥–∞:
```javascript
localStorage.removeItem('feature:match_ui_store'); // –æ—Ç–∫–ª—é—á–∏—Ç—å —Å—Ç–æ—Ä –¥–ª—è UI –¥–µ—Ç–∞–ª–µ–π –º–∞—Ç—á–∞
localStorage.removeItem('feature:admin:season_reset'); // –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–±—Ä–æ—Å —Å–µ–∑–æ–Ω–∞
```

### 2. –û—Ç–∫–∞—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Å—Ç–æ—Ä–∞ (—ç—Ç–∞–ø 1)

#### –°–∏–º–ø—Ç–æ–º—ã –ø—Ä–æ–±–ª–µ–º —Å–æ —Å—Ç–æ—Ä–æ–º:
- UI –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –¥–∞–Ω–Ω—ã—Ö
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
- –û—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å `window.Store`, `window.MatchesStore`, etc.
- –ü—Ä–æ–±–ª–µ–º—ã —Å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏

#### –®–∞–≥–∏ –æ—Ç–∫–∞—Ç–∞:

1. **–ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä:**
   ```
   ?ff=0  // –æ—Ç–∫–ª—é—á–∞–µ—Ç feature:match_ui_store
   ```

2. **–ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞—Ç —Å—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ localStorage:**
   ```javascript
   // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç–æ—Ä–∞
   localStorage.removeItem('store:persist');
   Object.keys(localStorage).filter(k => k.startsWith('feature:')).forEach(k => localStorage.removeItem(k));
   location.reload();
   ```

3. **–û—Ç–∫–∞—Ç —Ñ–∞–π–ª–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω rollback –∫–æ–¥–∞):**
   - –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã `static/js/dist/*.js` (—Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π TypeScript)
   - –û—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `templates/index.html` (—É–±—Ä–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É dist —Ñ–∞–π–ª–æ–≤)
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –º–æ–¥—É–ª–µ–π –∏–∑ git

### 3. –û—Ç–∫–∞—Ç feature flags —Å–∏—Å—Ç–µ–º—ã (—ç—Ç–∞–ø 10)

#### –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ feature flags –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã:

1. **–£–¥–∞–ª–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ templates/index.html:**
   ```html
   <!-- –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç—É —Å—Ç—Ä–æ–∫—É -->
   <!-- <script src="/static/js/admin-feature-flags.js?v={{ static_version }}"></script> -->
   ```

2. **–û—á–∏—Å—Ç–∏—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–π fetch:**
   ```javascript
   // –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
   if (window.__ADMIN_FETCH_INTERCEPTED__) {
     location.reload(); // —ç—Ç–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π fetch
   }
   ```

3. **–£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª admin-feature-flags.js** –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä

### 4. –ü–æ—à–∞–≥–æ–≤—ã–π rollback –ø–æ –º–æ–¥—É–ª—è–º

#### –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –º–æ–¥—É–ª—è–º–∏:

**League –º–æ–¥—É–ª—å:**
```javascript
// –û—Ç–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å–æ —Å—Ç–æ—Ä–æ–º
localStorage.removeItem('store:league');
// –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ legacy –ª–æ–≥–∏–∫–µ
location.reload();
```

**Predictions –º–æ–¥—É–ª—å:**
```javascript
// –û—Ç–∫–ª—é—á–∏—Ç—å —Å—Ç–æ—Ä –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤
localStorage.removeItem('store:predictions');
localStorage.removeItem('store:odds');
location.reload();
```

**Profile –º–æ–¥—É–ª–∏:**
```javascript
// –û—Ç–∫–ª—é—á–∏—Ç—å —Å—Ç–æ—Ä –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è
localStorage.removeItem('store:profile');
location.reload();
```

### 5. Rollback —á–µ—Ä–µ–∑ Render (infrastructure)

#### –û—Ç–∫–∞—Ç deployment –Ω–∞ Render:

1. **–ó–∞–π—Ç–∏ –≤ Render Dashboard**
2. **–í—ã–±—Ä–∞—Ç—å service "liga-obninsk"**
3. **–ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª "Deploys"**
4. **–í—ã–±—Ä–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Å–ø–µ—à–Ω—ã–π deploy**
5. **–ù–∞–∂–∞—Ç—å "Redeploy"**

#### –û—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ Git:
```bash
# –ù–∞–π—Ç–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–æ–º–º–∏—Ç
git log --oneline -10

# –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –∫ –Ω–µ–º—É
git reset --hard <commit-hash>

# –§–æ—Ä—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π push (–û–°–¢–û–†–û–ñ–ù–û!)
git push --force-with-lease origin main
```

### 6. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

#### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ feature flags:
```javascript
console.table(
  Object.keys(localStorage)
    .filter(k => k.startsWith('feature:'))
    .reduce((acc, k) => { acc[k] = localStorage.getItem(k); return acc; }, {})
);
```

#### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å—Ç–æ—Ä–∞:
```javascript
console.log('Store state:', {
  core: window.Store?.get?.(),
  matches: window.MatchesStore?.get?.(),
  league: window.LeagueStore?.get?.(),
  predictions: window.PredictionsStore?.get?.()
});
```

#### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—à–∏–±–∫–∏ JavaScript:
- –û—Ç–∫—Ä—ã—Ç—å DevTools ‚Üí Console
- –ò—Å–∫–∞—Ç—å –æ—à–∏–±–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å `Store`, `AdminFeatureFlags`, `fetch intercepted`

### 7. –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã

#### –ï—Å–ª–∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞:
1. –ó–∞–π—Ç–∏ —á–µ—Ä–µ–∑ –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É: `/admin_dashboard.html`
2. –ò–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –≤—Å–µ feature flags —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
3. –ò–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –Ω–∞ Render

#### –ï—Å–ª–∏ —Å–∞–π—Ç –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ Render
2. –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π deploy
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ healthcheck endpoints

#### –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ AdminLogs –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å backup –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
3. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ Google Sheets (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π/–∫–æ–º–∞–Ω–¥)

### 8. –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ —ç—Å–∫–∞–ª–∞—Ü–∏—è

- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
- **–õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã**: `/api/admin/logs` (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∞)
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: `/healthz`, `/version`, `/features` endpoints

### 9. –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è rollback

- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–∞—Å—à—Ç–∞–± –ø—Ä–æ–±–ª–µ–º—ã (–ª–æ–∫–∞–ª—å–Ω–∞—è/–≥–ª–æ–±–∞–ª—å–Ω–∞—è)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å feature flags –≤ localStorage
- [ ] –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å URL –ø–∞—Ä–∞–º–µ—Ç—Ä `?ff=0`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
- [ ] –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å deployment –Ω–∞ Render
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç –¥–ª—è –±—É–¥—É—â–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π

---

**–í–ê–ñ–ù–û**: –í—Å–µ–≥–¥–∞ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–π—Ç–µ –±—ã—Å—Ç—Ä—ã–µ –º–µ—Ç–æ–¥—ã –æ—Ç–∫–∞—Ç–∞ (feature flags, URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) –ø–µ—Ä–µ–¥ –ø–æ–ª–Ω—ã–º rollback –∫–æ–¥–∞ –∏–ª–∏ deployment.