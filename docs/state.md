# –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–æ—Ä (—ç—Ç–∞–ø 1)

–¶–µ–ª—å: –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–µ–∑ –±–∞–Ω–¥–ª–µ—Ä–∞, –Ω–∞ Vanilla JS. –í —ç—Ç–æ–º —ç—Ç–∞–ø–µ –≤–Ω–µ–¥—Ä—ë–Ω –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å—Ç–æ—Ä —Å –ø—Ä–æ—Å—Ç—ã–º —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–º API –∏ —á–∞—Å—Ç–∏—á–Ω–æ–π –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏–µ–π.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è: —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ª—ë–≥–∫–∏–π —Å—Ç–æ—Ä –Ω–∞ —Å–æ–±—ã—Ç–∏—è—Ö (subscribe/notify), –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
- –§–∞–π–ª—ã:
  - `static/js/store/core.js` ‚Äî —è–¥—Ä–æ —Å—Ç–æ—Ä–∞: createStore, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏—è (LocalStorage, TTL), —ç–∫—Å–ø–æ—Ä—Ç –≤ `window.Store`.
  - `static/js/store/app.js` ‚Äî —Å—Ä–µ–∑ app: `ready`, `startedAt` (–Ω–µ –ø–µ—Ä—Å–∏—Å—Ç–∏—Ç—Å—è).
  - `static/js/store/user.js` ‚Äî —Å—Ä–µ–∑ user: `id`, `name`, `role`, `flags` (persist, TTL=7d).
  - `static/js/store/ui.js` ‚Äî —Å—Ä–µ–∑ ui: `activeTab`, `theme`, `modals` (—á–∞—Å—Ç–∏—á–Ω–æ persist, TTL=14d).
 - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ —à–∞–±–ª–æ–Ω: `templates/index.html` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é dist-first:
   - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–∞–∑–æ–≤—ã–µ —Å—Ä–µ–∑—ã (`dist/store/core.js`, `app.js`, `user.js`, `ui.js`) —Å –ø–æ—Ñ–∞–π–ª–æ–≤—ã–º fallback –Ω–∞ `static/js/store/*.js`;
   - –∑–∞—Ç–µ–º –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ä–µ–∑—ã –∏–∑ `dist/store/` (realtime, league, matches, odds, predictions, shop, profile) –±–µ–∑ –æ—à–∏–±–æ–∫, –µ—Å–ª–∏ –∏—Ö –ø–æ–∫–∞ –Ω–µ—Ç.
 - –°–±–æ—Ä–∫–∞ TypeScript: –Ω–∞ —ç—Ç–∞–ø–µ Render build –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ø—ã—Ç–∫–∞ `npx tsc -p tsconfig.json` –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ Node; –µ—Å–ª–∏ Node –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ legacy JS, –∞ dist –±—É–¥–µ—Ç –ø—É—Å—Ç—ã–º (fallback —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è).

## –ü—É–±–ª–∏—á–Ω—ã–π API

–û–±—â–∏–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Å—Ç–æ—Ä–∞:
- `const s = Store.createStore(name, initialState, { persistKey?, persistPaths?, ttlMs? })`
- –ú–µ—Ç–æ–¥—ã: `s.get()`, `s.set(partial)`, `s.update(mutator)`, `s.subscribe(fn)`
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: `Store._stores[name]` –∏ `Store.getStore(name)`

–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ä–µ–∑—ã:
- `window.AppStore` ‚Äî —Ñ–ª–∞–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `window.UserStore` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (persist)
- `window.UIStore` ‚Äî UI (—á–∞—Å—Ç–∏—á–Ω—ã–π persist) + —É–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã: `setActiveTab(tab)`, `setTheme(theme)`

## –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ü–∏—è

- –¢–æ–ª—å–∫–æ whitelisted –ø–æ–ª—è (`persistPaths`) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ LocalStorage
- –ó–∞–ø–∏—Å—å —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è —Ç–∞–π–º—à—Ç–∞–º–ø–æ–º `__ts`, TTL –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –≥–∏–¥—Ä–∞—Ü–∏–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –≤ user-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã/—Ç–æ–∫–µ–Ω—ã

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º (–¥–∞–ª—å—à–µ –ø–æ roadmap)

- –°–µ—Ç—å/–∫—ç—à: –≤ `etag-fetch.js` –¥–æ–±–∞–≤–∏—Ç—å —Ö—É–∫–∏ `onSuccess`, `onStale` –∏ –¥–∏—Å–ø–∞—Ç—á–∏—Ç—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–æ—Ä—ã (league/matches/predictions) ‚Äî –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–¥–∞—á–∞—Ö
- –†–µ–∞–ª—Ç–∞–π–º: `realtime-updates.js` –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ —Å—Ç–æ—Ä ‚Äî –ø–æ—Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø
- –ú–æ–¥—É–ª–∏ UI: –∑–∞–º–µ–Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö Maps –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏–∑ —Å—Ç–æ—Ä–∞ –∏ –ø–æ–¥–ø–∏—Å–∫–∏ (–ø–æ —á–∞—Å—Ç—è–º, –ø–æ–¥ —Ñ–∏—á–∞-—Ñ–ª–∞–≥–æ–º)

## –í–ª–∏—è–Ω–∏–µ –Ω–∞ –º–µ—Ç—Ä–∏–∫–∏

- Tech Stability: üî¥ ‚Äî –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã —Å–Ω–∏–∂–∞–µ—Ç –±–∞–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ —Ä–∞–∑—ä–µ–∑–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π
- Engagement: üîµ ‚Äî –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ¬´–º–∏–≥–∞–Ω–∏–π¬ª –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞—Ö –≤–∫–ª–∞–¥–æ–∫
- Retention: ‚ö™ ‚Äî –∫–æ—Å–≤–µ–Ω–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ —á–µ—Ä–µ–∑ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- Revenue: ‚ö™ ‚Äî –±–µ–∑ –ø—Ä—è–º–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Å—Ä–µ–∑–æ–≤ (`league`, `matches`, `odds`, `predictions`, `shop`, `profile`, `realtime`) –¥–æ–ø–æ–ª–Ω—è–π—Ç–µ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç: –ø–æ–ª—è, persistPaths, TTL, —Å–æ–±—ã—Ç–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, —Ç–æ—á–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (HTTP/WS).

---

## –ù–æ–≤—ã–µ —Å—Ä–µ–∑—ã —Å–æ—Å—Ç–æ—è–Ω–∏—è (TS)

- league (no persist)
  - state: `{ table: any[]; stats: any[]; schedule: { tours: any[]; lastUpdated: number|null; etag?: string|null } }`
  - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑: etag-fetch (schedule/table/stats), WS –ø–∞—Ç—á–∏

- matches (no persist)
  - state: `{ map: Record<string, { info: MatchInfo|null; score: MatchScore|null; events: MatchEvent[]; lastUpdated: number|null }> }`
  - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑: etag-fetch (–¥–µ—Ç–∞–ª–∏ –º–∞—Ç—á–∞), WS —Å–æ–±—ã—Ç–∏—è (–≥–æ–ª—ã, –∫–∞—Ä—Ç–æ—á–∫–∏, —Ç–∞–π–º–µ—Ä)

- odds (no persist)
  - state: `{ map: Record<string, { value: number; version: number; lastUpdated: number }> }`
  - –∫–ª—é—á–∏: `"<matchId>|1x2|home|draw|away"`, `"<matchId>|totals|over|<line>"`, `"<matchId>|totals|under|<line>"`, `"<matchId>|penalty|yes|no"`, `"<matchId>|redcard|yes|no"`
  - `<matchId>` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ `home_away_YYYY-MM-DD`
  - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑: etag-fetch (–ø—Ä–µ–¥–∏–∫—à–µ–Ω—ã) + WS –ø–∞—Ç—á–∏ (—Å—Ö–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞)

- predictions (no persist)
  - state: `{ items: PredictionItem[]; myVotes: Record<string, any>; ttl: number|null }`
  - items: –º–∞—Å—Å–∏–≤ –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ä—ã–Ω–∫–æ–≤ –ø–æ –º–∞—Ç—á–∞–º (`{ id, matchId, market: 'available', options: [...] }`)
  - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑: etag-fetch (—Å–ø–∏—Å–∫–∏), –ª–æ–∫–∞–ª—å–Ω–æ: –∫—ç—à myVotes —Å TTL (–ø–µ—Ä–µ–∑–∞–ø—Ä–æ—Å –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏)

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ETag/WS ‚Üí Store (—Å–≤–æ–¥–∫–∞):
- predictions.js —Ç–µ–ø–µ—Ä—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ `/api/betting/tours` –æ–±–Ω–æ–≤–ª—è–µ—Ç OddsStore –∏ PredictionsStore
- realtime-updates.js –¥–∏—Å–ø–∞—Ç—á–∏—Ç `bettingOddsUpdate` –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI; –ø–æ—Å–ª–µ–¥—É—é—â–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ OddsStore –≤–æ–∑–º–æ–∂–Ω–∞ (–ø–æ–¥ —Ñ–∏—á–∞-—Ñ–ª–∞–≥)
 - realtime (store) –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å —Å–æ–±—ã—Ç–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è/–ø–æ–¥–ø–∏—Å–æ–∫ –∏ –æ—Ç—Ä–∞–∂–∞—Ç—å –∏—Ö –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ (`connected`, `topics`, `reconnects`) –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫ UI (—ç—Ç–∞–ø 1. –∞–¥–∞–ø—Ç–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

- shop (persist)
  - state: `{ cart: ShopCartItem[]; orders: ShopOrder[]; ttl: number|null }`
  - persistPaths: `["cart","orders","ttl"]`, TTL: 14d
  - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑: UI-–¥–µ–π—Å—Ç–≤–∏–π –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π API

- profile (no persist)
  - state: `{ achievements: Achievement[]; badges: string[]; lastUpdated: number|null }`
  - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑: etag-fetch (–ø—Ä–æ—Ñ–∏–ª—å/–∞—á–∏–≤–∫–∏)

- realtime (no persist)
  - state: `{ connected: boolean; topics: string[]; reconnects: number }`
  - –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑: realtime-updates.js (—Å–æ–±—ã—Ç–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è/–ø–æ–¥–ø–∏—Å–∫–∏)

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã `MatchInfo`, `MatchScore`, `PredictionItem`, `Achievement`, `ShopCartItem`, `ShopOrder` ‚Äî –∑–∞–¥–∞–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö `.ts` –∏ –º–æ–≥—É—Ç —É—Ç–æ—á–Ω—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å API.
